@using WebSiteBanHang.ViewModels;

@model IEnumerable<KhachHang_GioHangViewModel>

@{
  ViewBag.Title = "XemGioHang";
  Layout = "~/Views/Layout/ProductLayout.cshtml";

}
<div class="cart-header col-md-9">
  @foreach (var item in Model)
  {
    using (Html.BeginForm("CapNhatGioHang", "GioHang", new { maGioHang = item.MaGioHang, maSP = item.MaSP, soLuong = item.SoLuong }))
    {
      @*<div class="close"> </div>*@
      <div class="cart-sec simpleCart_shelfItem">
        <div class="cart-item cyc">
          <img src="@Url.Content("~/Content/HinhAnhSP/" + item.HinhAnh)" class="img-responsive" alt="" />
        </div>
        <div class="cart-item-info">
          <h3><a href="#">@item.TenSP</a></h3>
          <ul class="qty col-md-6">
            <li><p>Đơn giá: @item.DonGia</p></li>
            <li><p>Số lượng: <input type="text" id="quantity" name="soLuongMoi" class="form-control input-number" value=@item.SoLuong></p></li>
            @*<li><p>Số lượng: @item.SoLuong</p></li>*@
            @*<li>
              Số lượng:
              <div class="center">
                <p></p>
                <div class="input-group">
                  <span class="input-group-btn">
                    <button type="button" class="btn btn-default btn-number" disabled="disabled" data-type="minus" data-field="quant[1]">
                      <span class="glyphicon glyphicon-minus"></span>
                    </button>
                  </span>
                  <input type="text" name="quant[1]" class="form-control input-number" value="1" min="1" max="50">
                  <span class="input-group-btn">
                    <button type="button" class="btn btn-default btn-number" data-type="plus" data-field="quant[1]">
                      <span class="glyphicon glyphicon-plus"></span>
                    </button>
                  </span>
                </div>
              </div>
            </li>*@
          </ul>
          <div>
            @*<input type="button" class="btn btn-primary col-md-2 edit_on" value="Sửa" />*@
            <input type="submit" class="btn btn-primary col-md-2 save_on" value="Lưu" />
            <a href="@Url.Action("XoaSanPhamKhoiGioHang","GioHang",new { @maSP =item.MaSP, @maGioHang =item.MaGioHang})" class="btn btn-primary col-md-2">Xóa</a>
            @*<input type="button" class="btn btn-primary col-md-2" value="Xóa" />*@
          </div>
          @*<div class="delivery">
              <p>Service Charges : Rs.100.00</p>
              <span>Delivered in 2-3 bussiness days</span>
              <div class="clearfix"></div>
            </div>*@
        </div>
        <div class="clearfix"></div>
      </div>
    }
  }
</div>
<div class="col-md-3 cart-total">
  <a class="continue" href="#">Tiếp tục mua hàng</a>
  <div class="price-details">
    <h3>Thanh toán chi tiết</h3>
    <span>Tổng tiền</span>
    <span class="total1">@ViewBag.TongTienDonHang</span>
    <span>Giảm giá</span>
    <span class="total1">---</span>
    @*<span>Phí vận chuyển</span>
      <span class="total1">150.00</span>*@
    <div class="clearfix"></div>
  </div>
  <ul class="total_price">
    <li class="last_price"> <h4>Tổng cộng</h4></li>
    <li class="last_price"><span>@ViewBag.TongTienDonHang</span></li>
    <div class="clearfix"> </div>
  </ul>
  <div class="clearfix"></div>
  <a class="order" href="@Url.Action("DatHang","GioHang",new {@maGioHang=ViewBag.maGioHang,@maKH=ViewBag.maKH })">Đặt hàng</a>
</div>
<script>
  $('.edit_on').click(function () {
    debugger
    $('#quantity').prop('disabled', false);
  })
  $('.save_on').click(function () {
    debugger
    $('#quantity').prop('disabled', true);
  }
//$('.btn-number').click(function (e) {
//      debugger
//      e.preventDefault();
//      fieldName = $(this).attr('data-field');
//      type = $(this).attr('data-type');
//      var input = $("input[name='" + fieldName + "']");
//      var currentVal = parseInt(input.val());
//      if (!isNaN(currentVal)) {
//        if (type == 'minus') {

//          if (currentVal > input.attr('min')) {
//            input.val(currentVal - 1).change();
//          }
//          if (parseInt(input.val()) == input.attr('min')) {
//            $(this).attr('disabled', true);
//          }

//        } else if (type == 'plus') {

//          if (currentVal < input.attr('max')) {
//            input.val(currentVal + 1).change();
//          }
//          if (parseInt(input.val()) == input.attr('max')) {
//            $(this).attr('disabled', true);
//          }

//        }
//      } else {
//        input.val(0);
//      }
//    });
//  $('.input-number').focusin(function () {
//    $(this).data('oldValue', $(this).val());
//  });
//  $('.input-number').change(function () {

//    minValue = parseInt($(this).attr('min'));
//    maxValue = parseInt($(this).attr('max'));
//    valueCurrent = parseInt($(this).val());

//    name = $(this).attr('name');
//    if (valueCurrent >= minValue) {
//      $(".btn-number[data-type='minus'][data-field='" + name + "']").removeAttr('disabled')
//    } else {
//      alert('Sorry, the minimum value was reached');
//      $(this).val($(this).data('oldValue'));
//    }
//    if (valueCurrent <= maxValue) {
//      $(".btn-number[data-type='plus'][data-field='" + name + "']").removeAttr('disabled')
//    } else {
//      alert('Sorry, the maximum value was reached');
//      $(this).val($(this).data('oldValue'));
//    }


//  });
//  $(".input-number").keydown(function (e) {
//    // Allow: backspace, delete, tab, escape, enter and .
//    if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 190]) !== -1 ||
//      // Allow: Ctrl+A
//      (e.keyCode == 65 && e.ctrlKey === true) ||
//      // Allow: home, end, left, right
//      (e.keyCode >= 35 && e.keyCode <= 39)) {
//      // let it happen, don't do anything
//      return;
//    }
//    // Ensure that it is a number and stop the keypress
//    if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
//      e.preventDefault();
//    }
//  });
</script>